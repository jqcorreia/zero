import "std/c"

external "raylib" {
    fn InitWindow(width: i32, height: i32, title: str)
    fn BeginDrawing()
    fn EndDrawing()
    fn ClearBackground(color: Color)
    fn DrawRectangle(x: i32, y: i32, w: i32, h: i32, color: Color)
    fn GetKeyPressed() -> i32
    fn IsKeyPressed(key: i32) -> bool
    fn TakeScreenshot(filename: str)
    fn DrawText(text: str, posX: i32, posY: i32, fontSize: i32, color: Color)    
}

struct Color {
    r: u8
    g: u8
    b: u8
    a: u8
}

fn main() {
    W := 800
    H := 600

    color := Color{ r = 128, g = 128, b = 128, a = 255 }
    BLUE := Color{ r = 0, g = 121, b = 241, a = 255 }

    dir := 1

    InitWindow(W, H, "Hello Raylib")

    x: i32 = 0

    speed := 10
    text_color := Color { r = 0, g = 128, b = 0, a = 255 }

    for {
        keypressed := GetKeyPressed()

        if keypressed != 0 {
            printf("Key pressed: %d\n", keypressed)
        }
        if IsKeyPressed(256) { // escape key
            break
        }
        if keypressed == 80 { // escape key
           TakeScreenshot("screenshot.png")
        }
        if IsKeyPressed(263) { 
            printf("Hello")
            x = x - speed
        }
        if IsKeyPressed(262) { 
            x = x + speed
        }
        // if dir == 1 {
        //     x = x + 1
        // }
        // if dir == 2 {
        //     x = x - 1
        // }
        // if x > W - 50 {
        //     dir = 2
        // }
        // if x < 0 {
        //     dir = 1
        // }

        BeginDrawing()
        ClearBackground(color)
        DrawText("Press P for screenshot", 10, 10, 24, Color { r = 0, g = 128, b = 0, a = 255 })
        DrawRectangle(x, H / 2 - 25, 50, 50, BLUE)
        EndDrawing()
    }
}

